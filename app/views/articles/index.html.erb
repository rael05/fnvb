<p style="color: green"><%= notice %></p>

<div class="shadow p-3 rounded-3">
  <h1 class="text-center border-bottom pb-2">
    Articles
    <a href="<%= new_article_path %>" style="text-decoration: none" class="ms-3">
      <i class="fa-solid fa-circle-plus fa-xs"></i>
    </a>
  </h1>

  <div id="articles" class="mt-2 row row-cols-1 row-cols-sm-2 row-cols-lg-3 row-cols-xl-4 g-3">
    <% @articles.each_with_index do |article, index| %>
      <div class="col">
        <div class="card <%= "bg-black bg-opacity-25" unless article.enabled%>">
          <a href="<%= article_path(article) %>">
            <% opacity = article.enabled ? 'opacity: 1;' : 'opacity: 0.3;' %>
            <% if article.image.present? %>
              <%= image_tag article.image, class: 'card-img-top', style: opacity %>
            <% end %>
          </a>
          <div class="card-body">
            <h5 class="card-title">
              <a href="<%= article_path(article) %>" class="link-dark" style="text-decoration: none">
                <%= article.title.truncate(50) %>
              </a>
            </h5>
            <p class="card-text">
              <%= article.description.truncate(90) %>
              <a href="<%= article_path(article) %>"> Leer más. </a>
            </p>
          </div>
          <div class="card-footer">
            <small class="text-body-secondary">
              Creada el <%= article.created_at.strftime('%b %d, %Y') %>
              <br>
              Ultima modificación <%= article.updated_at.strftime('%b %d, %Y') %>
              <br>
              Escrita por <%= article.user.full_name.truncate(28) %>
              <br>
              <div class="row ms-0 mt-1">
                <div class="border rounded-circle position-relative bg-white" style="width: 30px; height: 30px">
                  <a href="<%= edit_article_path(article) %>" style="text-decoration: none" class="link-success position-absolute top-50 start-50 translate-middle">
                    <i class="fa-solid fa-pen-to-square"></i>
                  </a>
                </div>
                <div class="border rounded-circle position-relative bg-white ms-1" style="width: 30px; height: 30px">
                  <!-- Botón para abrir el modal -->
                  <a href="#" data-bs-toggle="modal" data-bs-target="#modal-<%= index %>" style="text-decoration: none" class="link-danger position-absolute top-50 start-50 translate-middle">
                    <i class="fa-solid <%= article.enabled ? "fa-eye-slash" : "fa-eye" %>"></i>
                  </a>
                </div>
              </div>
            </small>
          </div>
        </div>
      </div>

      <!-- Modal para cambiar enabled -->
      <div class="modal fade" id="modal-<%= index %>" tabindex="-1" aria-labelledby="modalLabel-<%= index %>" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalLabel-<%= index %>">
                <%= article.enabled ? "Deshabilitar artículo" : "Habilitar artículo" %>
              </h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
              ¿Estás seguro que deseas <%= article.enabled ? "deshabilitar" : "habilitar" %> el artículo: "<%= article.title %>"?
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              <%= button_to (article.enabled ? "Deshabilitar" : "Habilitar"),
                    enable_change_article_path(article),
                    method: :patch,
                    class: "btn btn-danger",
                    form: { data: { turbo: false } } %>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
  <%= link_to "New article", new_article_path, class: 'btn btn-primary mt-3' %>
</div>
